<!doctype html>
<html class="no-js" lang="en" ng-app="treatmentPlan">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Treatment Plan</title>
    <link rel="stylesheet" type="text/css" href="//cloud.typography.com/6681852/682448/css/fonts.css" />
    <link rel="stylesheet" href="stylesheets/app.css" />
    <script src="bower_components/modernizr/modernizr.js"></script>
    <!-- AngularJS -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular-resource.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular-route.min.js"></script>

    <!-- Firebase -->
    <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>

    <!-- AngularFire -->
    <script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>

    <script src="js/app.js"></script>
  </head>
  <body>

    <div class="header-bg">
      <!-- <a href="#content" class="chevron">
        Click to bring content to top
      </a> -->
      <div class="row">
        <div class="large-12 columns hero">
          <div class="large-12 top-bar">
            <div class="large-4 logo-bar">
              <div class="bupa"></div>
              <div class="dentist-logo"></div>
            </div>

            <div class="large-3 large-offset-6 columns profile-bar">
              <div class="profile">
                <a href="#">My History</a>
              </div>
            </div>
          </div>

          <div class="large-12 clear greeting-container">
            <div class="large-7">
              <h2>Hi Liam</h2>
              <h3>Let’s get that tooth sorted out.</h3>
              <span>Dr. Mark Johnson,<br />
              Bexley Clinic</span>
            </div>
          </div>
        </div>        

      </div>
    </div>

    <div class="row margin-top-4" id="content">
      <div class="large-5 columns bg-2 container">
        <div class="large-12 columns">
          <div class="issue root-canal">
            <span>Your issue</span>
            <h3>Root canal infection</h3>
          </div>
        </div>
      </div>
      <div class="large-7 columns subtle-shade-bg-3 container">
        <div class="large-12 columns">
          <div class="plan">
            <p>When we last met we identified an abcess in your lower left molar. We agreed that immediate root canal treatment is required to not only alleviate the pain but protect against more serious infection.</p>  
            <a href="#" class="button">See my treatment plan and costs</a>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns text-center bg-3 header-bar">
        <h3>YOUR NEXT APPOINTMENT</h3>
      </div>
    </div>

    <div class="row" id="appointmentDetails">

      <div class="large-4 subtle-shade-bg-5 appt-tile columns">
        <div class="large-12 columns appt-date vertical-center">
          <div class="large-6 columns">
            <span class="month">OCT</span>
            <span class="year">2015</span>
          </div> 
          <div class="large-6 columns">
            <span class="day-name">Saturday</span>
            <span class="day">14</span>
          </div>        
        </div>
      </div>
      <div class="large-4 subtle-shade-bg-3 appt-tile columns">
        <div class="large-12 columns appt-time vertical-center">
          <div class="large-12 columns">
            <span class="time">11:00</span>
            <span class="ampm">am</span>
            <div id="statusText" class="status right not-confirmed"><span class="text">Not Confirmed</span><span id="apptHelp" data-tooltip aria-haspopup="true" class="help has-tip" title="Please confirm your appointment by clicking on the button below."></span></div>
          </div>               
        </div>
      </div>
        
      <div class="large-4 subtle-shade-bg-4 appt-tile columns">
        <div class="large-12 columns clinic-address vertical-center">
          <div class="large-12 columns">
            <div class="clinic-name">Bexley Clinic</div>
            <div class="clinic-address">Suite 61, 47 Neridah Street Chatswood NSW 2067</div>
          </div>               
        </div>
      </div>

    </div>

    <div class="row">
      <div class="large-12 columns centered">
        <a href="#" id="btnConfirmAppointment" class="button large icon"><span>Confirm your appointment now</span><svg class="si-icon si-icon-clock" id="confirmIcon"></svg></a>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns" id="utilityBelt">
        <div class="large-4 columns calendar">
          <a href="#">Add to calendar</a>
        </div>

        <div class="large-4 columns location">
          <a href="#">Find clinic location</a>
        </div>

        <div class="large-4 columns sms">
          <a href="#">Request an SMS reminder</a>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns subtle-shade-bg-4 call">
        <div class="large-7 columns info">For more information or to change your appointment call</div>
        <div class="large-5 columns phone-number"><a href="tel:0279101112">02 7910 1112</a></div>
      </div>
    </div>

    <div class="row summary margin-top-bottom-2-5 collapse">
      <div class="large-12 columns primary-color-1-bg centered header">
        <h3>15th of September</h3>
      </div>
      <div class="large-12 columns no-border-top padding-top-bottom-2">
        <div class="large-11 large-centered columns">
          <h3>Today's appointment summary</h3>

          <p>
            Hi Liam,
          </p>
          <p>
            Here is a summary of what we found and discussed together at your last appointment. Damage to the root canal of your lower left 
            molar is the source of the pain you're currently experiencing.
          </p>
          <p>
            We agreed that immediate root canal treatment is required, not only to alleviate the pain, but to protect against more serious infection. 
          </p>
          <p>
            We also discussed the need for early intervention to protect against intensive and costly treatment down the track by filling a further 8 teeth.
          </p>
          <p>
            <a href="#" class="accordion chevron">Recommended next steps</a>
          </p>

          <hr />

          <blockquote>
            <p>
              I recognise that this represents a new and potentially worrying experience. Please be assured that we apply all the latest techniques and Gentle Dentistry approach. I’ve included information about the recommended <a href="#">oral sedation</a> and <a href="#">Gentle Dentistry</a>.
            </p>
          </blockquote>

          <p>
            Please don’t hesitate to call us if you have any questions or concerns – <strong>1234 56 56</strong>.
          </p>

          <p>
            Sincerely,<br />
            Dr. Mark Johns.
          </p>

        </div>
      </div>

      <div class="large-12 columns subtle-shade-bg-3 border padding-top-bottom-2">
        <div class="large-11 large-centered columns">
          <h4>Your mouth</h4>

          <p>
            Today we took photographs of your mouth to help inform the creation of detailed <a href="#">Treatment Plan</a> and also a <a href="#">Long-term Dental Health Recommendation</a>.
          </p>          

          <p>
            <a href="#" class="accordion chevron">See images</a>
          </p>

        </div>
      </div>
      
    </div>


    <div class="row summary margin-top-bottom-2-5 collapse">
      <div class="large-12 columns no-border-bottom padding-top-bottom-2">
        <div class="large-11 large-centered columns">
          <h3>Dental health</h3>
          <p>
            Lifestyle and physical predisposition has a significant impact on your dental health. A unique profile has been created for you and will serve as the basis of ongoing oral health management and recommendations.
          </p>            
          <p>
            <a href="#" class="accordion chevron" data-target="chartContainer">Read more</a>
          </p>
        </div>
      </div>
      <div class="large-12 hide" id="chartContainer">

        <div class="large-4 centered dental-health bg-1 columns">
          <a href="#" class="read-more" data-target="card1">Read more</a>
          <div class="container vertical-center">
            <div class="card" id="card1">
              <div class="surface front">
                <ul data-pie-id="sugarChart" data-options='{"percent__offset": 0}'>
                  <li data-value="25">Sugar</li>
                  <li data-value="75">Not Sugar</li>
                </ul>
                <div id="sugarChart"></div>

                <span class="label">Your sugar intake</span>
              </div>

              <div class="surface back">
                
                <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer commodo leo et sodales suscipit. Pellentesque ex arcu, molestie a accumsan porta, semper id orci. Vivamus imperdiet tempus turpis at rutrum. Curabitur hendrerit libero vel sollicitudin convallis. Proin scelerisque dolor lectus, a vehicula enim sodales eu. Curabitur mollis, velit sed consectetur pulvinar, libero lacus consequat metus, sit amet ornare enim eros id libero. Praesent suscipit libero lectus, consectetur placerat felis sagittis nec. Proin facilisis gravida felis at varius. Curabitur scelerisque eget lacus sed ullamcorper. Cras massa enim, hendrerit et elementum sit amet, condimentum eu urna. Nullam mollis, eros a euismod venenatis, odio magna scelerisque ex, in semper nunc lorem id dui. Ut ac suscipit augue. Duis in lacinia nulla, sit amet tincidunt augue.
                </p>
                <p>
                Aliquam vehicula enim vitae velit elementum ultricies. Donec congue justo non odio pharetra, vitae aliquet ipsum interdum. In facilisis ex lacus, et tempus orci finibus scelerisque. Sed rhoncus sem id enim convallis viverra. Sed urna metus, convallis ac nisl in, ornare semper justo. Aenean iaculis condimentum metus, eu lobortis diam finibus id. Aenean vulputate sapien sit amet bibendum pretium.
                </p>
                <p>
                Sed ac mollis magna. Praesent justo nisl, placerat ac neque id, commodo faucibus erat. Pellentesque in scelerisque metus. Duis volutpat, tortor ut vulputate faucibus, lectus metus egestas nisl, quis semper ligula eros eu ex. Quisque vel felis nisl. Suspendisse tincidunt venenatis commodo. Fusce in metus sed enim interdum consectetur vitae at tortor.
              </p>
              </div>
            </div>
          </div>
        </div>

        <div class="large-4 centered dental-health subtle-shade-bg-4 columns">
          <div class="container vertical-center">
            <div class="data-text">
              64%
            </div>

            <span class="label">Likely fail to floss on the weekends</span>
          </div>
            
        </div>

        <div class="large-4 dental-health bg-2 columns">
          <div class="container vertical-center">
            <ul data-bar-id="gumChart" data-options='{"percent__offset": -30}'>
              <li data-value="75">Smoker</li>
              <li data-value="25">Non-smoker</li>
            </ul>
            <div id="gumChart"></div>
          </div>
        </div>

      </div>

      <div class="large-12 columns no-border-top">
      </div>

    </div>


    <div class="row summary margin-top-2-5 collapse">
      <div class="large-12 columns primary-color-1-bg centered header">
        <h3>YOUR TREATMENT PLAN: ROOT CANAL THERAPY</h3>
      </div>

      <div class="large-12 columns no-border-top padding-top-bottom-2 subtle-shade-bg-3">               

        <div class="large-7 columns">
          <h4 class="accordion chevron left" data-target="treatmentOption1">Option 1: Root Canal Therapy <br />
          (Recommended)</h4>
        </div>
        
        <div class="large-5 columns text-right">
          <h4>Total $5663.00</h4>
        </div>

        <div class="large-12 columns padding-left-4">
          <p>
            I recommend Root canal therapy for you to eradicate the infection in your mouth. This is the preferred option because it’s always better to do everything possible to keep the teeth you have in your mouth. This is better for your overall ongoing health and avoids removing the tooth and the expense of replacing it.
          </p>
        </div>

      </div>
    </div>

    <div class="row collapse hide" id="treatmentOption1">
      <div class="large-12">
        <table cellpadding="0" cellspacing="0" border="0" class="plan-table">
          <thead>
            <tr>
              <th></th>
              <th>Visit</th>
              <th>Date</th>
              <th>Time</th>
              <th>Duration</th>
              <th>Alert</th>
              <th>Description</th>
              <th>Tooth</th>
              <th>Item code</th>
              <th>Cost</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><a href="#" class="accordion chevron-only" data-target="detailRow1">&nbsp;</a></td>
              <td>1</td>
              <td>05 August 2015</td>
              <td>09:30am</td>
              <td>150 min</td>
              <td><a href="#" class="alert has-tip" title="Oral sedation"></a></td>
              <td class="description"><strong>Root canal preparation and fillings</strong></td>
              <td></td>
              <td></td>
              <td class="cost">$1640.00</td>
            </tr>

            <tr class="hide" id="detailRow1">
              <td colspan="6"></td>
              <td colspan="4">
                <table cellpadding="0" cellspacing="0" border="0" class="detail-table">  
                  <thead>
                    <tr>
                      <th colspan="4" class="text-left">Root canal therapy</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                  </tbody>
                </table>

                <table cellpadding="0" cellspacing="0" border="0" class="detail-table">  
                  <thead>
                    <tr>
                      <th colspan="4" class="text-left">Root canal therapy</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>

                    <tr>
                      <td></td>
                      <td></td>
                      <td><strong>Total</strong></td>
                      <td class="cost"><strong>$1640.00</strong></td>
                  </tbody>
                </table>
              </td>
            </tr>


            <tr>
              <td><a href="#" class="accordion chevron-only" data-target="detailRow2">&nbsp;</a></td>
              <td>1</td>
              <td>05 August 2015</td>
              <td>09:30am</td>
              <td>150 min</td>
              <td><a href="#" class="alert has-tip" title="Oral sedation"></a></td>
              <td class="description"><strong>Root canal preparation and fillings</strong></td>
              <td></td>
              <td></td>
              <td class="cost">$1640.00</td>
            </tr>

            <tr class="hide" id="detailRow2">
              <td colspan="6"></td>
              <td colspan="4">
                <table cellpadding="0" cellspacing="0" border="0" class="detail-table">  
                  <thead>
                    <tr>
                      <th colspan="4" class="text-left">Root canal therapy</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                  </tbody>
                </table>

                <table cellpadding="0" cellspacing="0" border="0" class="detail-table">  
                  <thead>
                    <tr>
                      <th colspan="4" class="text-left">Root canal therapy</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>
                    <tr>
                      <td class="description">Root canal preparation - 1 Canal</td>
                      <td>37</td>
                      <td>415</td>
                      <td class="cost">$205.00</td>
                    </tr>

                    <tr>
                      <td></td>
                      <td></td>
                      <td><strong>Total</strong></td>
                      <td class="cost"><strong>$1640.00</strong></td>
                  </tbody>
                </table>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>



    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>

     <script src="bower_components/plugins/js/pizza.js"></script>
     <script src="bower_components/plugins/js/pizza/pie.js"></script>
     <script src="bower_components/plugins/js/pizza/line.js"></script>
     <script src="bower_components/plugins/js/pizza/bar.js"></script>

     <script src="bower_components/plugins/js/snap.svg.js"></script>

    <script src="js/app.js"></script>
    <script>

      var s = Snap('#confirmIcon');

      var clockCircle = s.circle(18, 18, 16);

      clockCircle.attr({
          fill: "transparent",
          stroke: "#fff",
          strokeWidth: 2.5
      });

      var minuteHand = s.line(18,20,18,5);
      var hourHand = s.line(19,20,8,18);

      minuteHand.attr({
        stroke: "#fff",
        strokeWidth: 2.5
      });
      hourHand.attr({
        stroke: "#fff",
        strokeWidth: 2.5
      });    


      Pizza.init();
      // Pizza.init(document.body, {
      //   percent_offset: 0
      // });


      $(document).foundation({
        // accordion: {
        //   // specify the class used for accordion panels
        //   content_class: 'content',
        //   // specify the class used for active (or open) accordion panels
        //   active_class: 'active',
        //   // allow multiple accordion panels to be active at the same time
        //   multi_expand: true,
        //   // allow accordion panels to be closed by clicking on their headers
        //   // setting to false only closes accordion panels when another is opened
        //   toggleable: true
        // },
        tooltip: {
          selector : '.has-tip',
          additional_inheritable_classes : [],
          tooltip_class : '.tooltip',
          touch_close_text: 'tap to close',
          disable_for_touch: false
        }
      });

      $(window).load(function() {
        // console.log('window height: ' + window.innerHeight);
        // console.dir(window)
        $('#heroImageContainer').css({
          'backgroundImage': 'url(stylesheets/img/hero-1.png)'
        });        
      });

      $(function() {

        $('.accordion').click(function(e) {
          e.preventDefault();


          var el = $('#'+$(this).attr('data-target')), curHeight = el.height(), autoHeight = el.css('height', 'auto').height();


          // console.log('==================================================');
          // console.dir(el);
          // console.log('current hieght: ' + curHeight);
          // console.log('auto hieght: ' + autoHeight);
          // console.log('==================================================');


          if (el.hasClass('hide'))
          {
            // console.log('open');
            el.removeClass('hide');
            $(this).addClass('show');
            curHeight = 0;
            el.height(curHeight).animate({height: autoHeight}, 500);
          }
          else
          {
            // console.log('close');
            $(this).removeClass('show');
            el.height(curHeight).animate({height: 0}, 500, function(){
              el.addClass('hide');  
            });             
          }
          
        });

        $('.read-more').click(function(e) {
          e.preventDefault();
          var el = $('#'+$(this).attr('data-target'));
          if (el.hasClass('flipped')) {
            el.removeClass('flipped');
          }  
          else 
          {
            el.addClass('flipped');[]
          }
        });

        $('#btnConfirmAppointment').click(function(e){
          e.preventDefault();

          if (!$(this).hasClass('success-bg')) {
            $(this).addClass('success-bg');

            minuteHand.animate( { transform: "t2.5,6r400,18,12"}, 600, mina.easeinout );
            
            hourHand.animate({ transform: "t1.5,3r200,13,19s0.65,1" },  600, mina.easeinout);

            $('#statusText').removeClass('not-confirmed').addClass('confirmed').children('span.text').text('Confirmed');
            $('#apptHelp').addClass('confirmed');
            $(this).children('span').text('Appointment confirmed');
            var tooltip = $('#'+ $('#apptHelp').attr('data-selector'));
            tooltip.text('For more information or to change your appointment call 02 7901 1112');
          }
        });


        function calcTotal(arr, target)
        {
          var total = 0;
          $.each(arr, function(key, value) {
            // console.log('key: ' + key);
            // console.log('value: ' + value.innerHTML);
            var subtotal = Number(value.innerHTML.replace('$',''));
            // console.log('Subtotal: ' + subtotal);
            // subtotal = subtotal.formatMoney(2, '.', ',');
            // console.log('Subtotal: ' + subtotal);
            total = Number(total + subtotal);
            // console.log('Total: ' + total)
          });
          total = total.formatMoney(2, '.', ',');
          // console.dir(target);
          // console.dir($('#summaryTotal'));
          target.text('$'+total);
        }

        calcTotal($('.subtotal'),$('#summaryTotal'));
      })

      Number.prototype.formatMoney = function(c, d, t){
      var n = this, 
          c = isNaN(c = Math.abs(c)) ? 2 : c, 
          d = d == undefined ? "." : d, 
          t = t == undefined ? "," : t, 
          s = n < 0 ? "-" : "", 
          i = parseInt(n = Math.abs(+n || 0).toFixed(c)) + "", 
          j = (j = i.length) > 3 ? j % 3 : 0;
         return s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
       };
    </script>
  </body>
</html>
